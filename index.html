<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EpubReader</title>
  <!-- JSZip -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <!-- EPUB.js -->
  <script src="lib/epub.min.js"></script>
  <!-- Supabase v1 -->
  <script src="https://unpkg.com/@supabase/supabase-js@1"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Barre sup√©rieure -->
  <header class="top-bar">
    <button class="menu-toggle" id="menu-toggle" aria-label="Menu">
      <span class="hamburger-icon">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>
    <div class="top-bar-user"></div>
  </header>

  <!-- Menu lat√©ral -->
  <nav class="side-menu" id="side-menu">
    <div class="side-menu-content">
      <div class="side-menu-user"></div>
      
      <div class="side-menu-items">
        <button class="side-menu-item active" data-tab="library">
          üìö Ma Biblioth√®que
        </button>
        <button class="side-menu-item" data-tab="catalog">
          üìñ Catalogue
        </button>
        <button class="side-menu-item" data-tab="search">
          üîç Rechercher
        </button>
        <button class="side-menu-item" data-tab="guide">
          üìñ Guide
        </button>
      </div>
      
      <button class="side-menu-logout" id="side-menu-logout">
        üö™ D√©connexion
      </button>
    </div>
  </nav>

  <!-- Overlay -->
  <div class="menu-overlay" id="menu-overlay"></div>

  <!-- Contenu de l'onglet Biblioth√®que -->
  <div id="library-tab" class="tab-content active">
    <div id="epub-list"></div>
  </div>

  <!-- Contenu de l'onglet Catalogue -->
  <div id="catalog-tab" class="tab-content">
    <div id="catalog-list"></div>
  </div>

  <!-- Contenu de l'onglet Recherche -->
  <div id="search-tab" class="tab-content">
    <div class="search-container">
      <div class="search-header">
        <h2>Rechercher sur Anna's Archive</h2>
        <p class="search-subtitle">Recherchez des EPUBs et ajoutez-les √† votre biblioth√®que</p>
      </div>
      
      <div class="search-box">
        <input 
          type="text" 
          id="search-input" 
          placeholder="Titre, auteur, ISBN..."
          autocomplete="off"
        >
        <button id="search-button">Rechercher</button>
      </div>

      <div id="search-status"></div>
      <div id="search-results"></div>
    </div>
  </div>

  <!-- Contenu de l'onglet Guide -->
  <div id="guide-tab" class="tab-content">
    <div class="guide-container">
      <h1 class="guide-title">üìñ Guide d'utilisation</h1>
      <p class="guide-intro">Apprenez √† ajouter des livres √† votre biblioth√®que en quelques clics !</p>

      <!-- M√©thode 1 : Catalogue -->
      <section class="guide-section">
        <h2 class="guide-section-title">
          <span class="guide-number">1</span>
          Ajouter depuis le Catalogue
        </h2>
        <p class="guide-description">Le moyen le plus rapide ! Les livres sont d√©j√† disponibles.</p>
        
        <div class="guide-steps">
          <div class="guide-step">
            <div class="guide-step-number">‚ë†</div>
            <div class="guide-step-content">
              <h3>Ouvrez l'onglet "üìñ Catalogue"</h3>
              <p>Vous verrez tous les livres d√©j√† pr√©sents dans la biblioth√®que commune.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë°</div>
            <div class="guide-step-content">
              <h3>Survolez un livre</h3>
              <p>Un bouton <strong>"+ Ajouter"</strong> appara√Æt sur les livres que vous n'avez pas encore.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë¢</div>
            <div class="guide-step-content">
              <h3>Cliquez sur "Ajouter"</h3>
              <p>‚úÖ <strong>C'est tout !</strong> Le livre est instantan√©ment ajout√© √† votre biblioth√®que.</p>
            </div>
          </div>
        </div>

        <div class="guide-tip">
          <strong>üí° Astuce :</strong> Si le bouton indique "‚úì Dans ma biblioth√®que", vous poss√©dez d√©j√† ce livre. Cliquez dessus pour le lire directement !
        </div>
      </section>

      <!-- M√©thode 2 : Anna's Archive -->
      <section class="guide-section">
        <h2 class="guide-section-title">
          <span class="guide-number">2</span>
          Ajouter depuis Anna's Archive
        </h2>
        <p class="guide-description">Pour les livres qui ne sont pas encore dans le catalogue.</p>
        
        <div class="guide-steps">
          <div class="guide-step">
            <div class="guide-step-number">‚ë†</div>
            <div class="guide-step-content">
              <h3>Ouvrez l'onglet "üîç Rechercher"</h3>
              <p>Entrez le titre, l'auteur ou l'ISBN du livre que vous cherchez.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë°</div>
            <div class="guide-step-content">
              <h3>Cliquez sur "Rechercher"</h3>
              <p>Les r√©sultats d'Anna's Archive s'affichent avec les couvertures et informations.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë¢</div>
            <div class="guide-step-content">
              <h3>Cliquez sur "‚ûï Ajouter"</h3>
              <p>Une fen√™tre s'ouvre ET une page Anna's Archive dans un nouvel onglet.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë£</div>
            <div class="guide-step-content">
              <h3>Sur Anna's Archive : passez la v√©rification</h3>
              <p>Cliquez sur "I'm not a robot" ou r√©solvez le CAPTCHA si demand√©.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë§</div>
            <div class="guide-step-content">
              <h3><strong>CLIC DROIT</strong> sur "Download"</h3>
              <p>Ne cliquez PAS normalement ! Faites un <strong>CLIC DROIT</strong> sur le bouton/lien de t√©l√©chargement.</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë•</div>
            <div class="guide-step-content">
              <h3>S√©lectionnez "Copier l'adresse du lien"</h3>
              <p>Dans le menu contextuel, choisissez "Copier l'adresse du lien" ou "Copy link address".</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ë¶</div>
            <div class="guide-step-content">
              <h3>Collez le lien dans la fen√™tre</h3>
              <p>Revenez √† l'onglet de l'application et collez le lien dans le champ pr√©vu (<kbd>Ctrl+V</kbd> ou <kbd>Cmd+V</kbd>).</p>
            </div>
          </div>

          <div class="guide-step">
            <div class="guide-step-number">‚ëß</div>
            <div class="guide-step-content">
              <h3>Cliquez sur "üì• T√©l√©charger et ajouter"</h3>
              <p>‚úÖ Le livre est t√©l√©charg√©, ajout√© au catalogue ET √† votre biblioth√®que !</p>
            </div>
          </div>
        </div>

        <div class="guide-warning">
          <strong>‚ö†Ô∏è Important :</strong> Vous devez faire un <strong>CLIC DROIT</strong> sur le bouton Download, pas un clic normal ! Sinon le t√©l√©chargement se fera dans votre navigateur au lieu de l'application.
        </div>

        <div class="guide-tip">
          <strong>üí° Bon √† savoir :</strong> Une fois ajout√© via Anna's Archive, le livre appara√Æt dans le Catalogue. Les autres utilisateurs pourront l'ajouter instantan√©ment sans repasser par Anna's Archive !
        </div>
      </section>

      <!-- Section FAQ -->
      <section class="guide-section">
        <h2 class="guide-section-title">
          <span class="guide-number">?</span>
          Questions fr√©quentes
        </h2>
        
        <div class="guide-faq">
          <div class="guide-faq-item">
            <h3>Quelle est la diff√©rence entre Catalogue et Recherche ?</h3>
            <p><strong>Catalogue</strong> = Livres d√©j√† disponibles (ajout instantan√©)<br>
            <strong>Recherche</strong> = Chercher de nouveaux livres sur Anna's Archive</p>
          </div>

          <div class="guide-faq-item">
            <h3>Le livre est d√©j√† dans le Catalogue, dois-je le re-t√©l√©charger ?</h3>
            <p>Non ! Utilisez le Catalogue pour l'ajouter instantan√©ment. Un seul fichier est stock√© pour tous les utilisateurs.</p>
          </div>

          <div class="guide-faq-item">
            <h3>Puis-je retirer un livre de ma biblioth√®que ?</h3>
            <p>Oui ! Dans le Catalogue, survolez un livre que vous poss√©dez. Le bouton devient "‚úï Retirer" (rouge). Cliquez pour le retirer de votre biblioth√®que personnelle. Le livre reste dans le Catalogue pour les autres.</p>
          </div>

          <div class="guide-faq-item">
            <h3>Le t√©l√©chargement √©choue, que faire ?</h3>
            <p>V√©rifiez que vous avez bien copi√© le lien de t√©l√©chargement DIRECT (celui qui commence par https://ipfs.io ou https://download.library.lol). Si le probl√®me persiste, essayez un autre lien de t√©l√©chargement sur Anna's Archive.</p>
          </div>
        </div>
      </section>

    </div>
  </div>

  <script src="auth.js"></script>
  <script src="index.js"></script>
  <script src="search.js"></script>
</body>
</html>
